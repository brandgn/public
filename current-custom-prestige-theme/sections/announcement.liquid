{%- if section.settings.enable_bar -%}
  {%- unless section.settings.home_page_only and template != 'index' -%}
    <section id="section-{{ section.id }}" data-section-id="{{ section.id }}" data-section-type="announcement-bar">
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/jquery.marquee/1.3.1/jquery.marquee.min.js"></script>
      <div class="AnnouncementBar">
        <div class="AnnouncementBar__Wrapper">
          <p class="AnnouncementBar__Content Heading">
            {%- if section.settings.link -%}
            <a href="{{ section.settings.link }}">
              <div class="marquee" style="white-space: normal;">
                <span>{{ section.settings.content | escape }}</span>
                <span>{{ section.settings.content | escape }}</span>
                <span>{{ section.settings.content | escape }}</span>
              </div>
            </a>
            {%- else -%}
              <div class="marquee">
                <span>{{ section.settings.content | escape }}</span>
                <span>{{ section.settings.content | escape }}</span>
                <span>{{ section.settings.content | escape }}</span>
                <span>{{ section.settings.content | escape }}</span>
                <span>{{ section.settings.content | escape }}</span>
              </div>
            {%- endif -%}
          </p>
        </div>
      </div>
    </section>

<style>
  #section-{{ section.id }} {
    background: {{ section.settings.background }};
    color: {{ section.settings.text_color }};
  }
  .AnnouncementBar__Wrapper{
      padding: 2px 15px !important;
  }
</style>

<script>
  document.documentElement.style.setProperty('--announcement-bar-height', document.getElementById('shopify-section-announcement').offsetHeight + 'px');
</script>
<script>
  $('.marquee').marquee({
    duration: 12000,
    gap: 50,
    delayBeforeStart: 0,
    direction: 'left',
    duplicated : true,
    startVisible : true
  });
</script>
<style>
  {{ section.settings.font_new | font_face}} 
  .marquee {
    overflow: hidden;
    font-size: {{section.settings.font-size}};
    font-family:	{{ section.settings.font_new.family }}, {{ section.settings.font_new.fallback_families }};
    font-weight: 	{{ section.settings.font_new.weight }};
    font-style: 	{{ section.settings.font_new.style }};
  }
  @media only screen and (max-width: 600px) {
    .marquee {
      font-size: {{section.settings.font-size-mobile}};
    }
  }
  .marquee {
    overflow: hidden;
  }

  .marquee span {
    display: inline-block;
    margin-right: 50px; /* same as the width of .marquee */
  }

  .marquee span:last-child {
    margin-right: 0;
  }
</style>
  {%- endunless -%}
{%- endif -%}

{% schema %}
{
  "name": "Announcement bar",
  "settings": [
    {
      "type": "checkbox",
      "id": "enable_bar",
      "label": "Enable bar",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "enable_scroll",
      "label": "Enable Scrolling Effect",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "home_page_only",
      "label": "Home page only",
      "default": false
    },
    {
      "type": "color",
      "id": "background",
      "label": "Background",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text",
      "default": "#ffffff"
    },
    {
      "type": "text",
      "id": "content",
      "label": "Text",
      "default": "Announce something here"
    },
    {
      "type": "url",
      "id": "link",
      "label": "Link"
    },
      {
        "type": "text",
        "id": "font-size",
        "label": "Font Size",
        "default": "30px"
      },
      {
        "type": "text",
        "id": "font-size-mobile",
        "label": "Font Size (Mobile)",
        "default": "50px"
      },
   {
     "type": "font_picker",
     "id": "font_new",
     "label": "Font",
     "default": "work_sans_n6"
   }
  ]
}
{% endschema %}